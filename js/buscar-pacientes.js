var botonBuscar = document.querySelector("#buscar-paciente");

botonBuscar.addEventListener("click", function(){ // AHORA LO QUE HAREMOS ES TRAER UNA API PARA PODER MOSTRAR LOS DATOS, SON DE UN REPOSITORIO EN GITHUB, PERO SIMULAMOS QUE ES UN SERVIDOR APARTE.
    
    var xhr = new XMLHttpRequest; //EL OBJETO AJAX "XMLHttpRequest" NOS AYUDARA A TRAER OTROS DATOS, PARA HACER LA REQUISICION. UTILIZAMOS UN "new" PARA HACER REFERNCIA (INSTANCIAR) AL OBJETO NUEVO QUE CREE, EN ESTE CASO, LA REQUISICION.

    xhr.open("GET","https://alura-es-cursos.github.io/api-pacientes/pacientes.json"); // CON EL ".open" LE DECIMOS QUE QUEREMOS QUE LO HABRA, PONIENDO DOS PARAMETROS, EL PRIMERO ES EL METODO, QUE QUIERE DECIR "OBTENER" Y EL SEGUNDO PARAMETRO ES LA URL QUE QUEREMOS CAPTURAR, ESTO SERIA: OBTENEME ESTO DE ESTA URL...

    xhr.addEventListener("load",function(){ // ESCUCHAMOS EL EVENTO DE NUESTRA VARIABLE Y LE DECIMOS PASANDO COMO PARAMETRO, QUE CARGUE LO QUE LE ACABAMOS DE PASAR...

        var errorAjax = document.querySelector("#error-ajax");

        if (xhr.status == 200) { // CON LA PROPIEDAD ".status" COMPROBAMOS EL ESTADO DEL ARCHIVO QUE FUE CARGADO, SI ES IGUAL A 200 (CODIGO QUE DICE QUE ESTA TODO BIEN) HAGA TODO EL COMANDO PARA PODER MOSTRAR LOS DATOS.

            errorAjax.classList.add("invisible"); // SI ESTA TODO OK, HACEME INVISIBLE EL SPAN, NO ME LO MOSTRES.

            var respuesta = xhr.responseText; // AHORA SI ESTAMOS TRAYENDO LOS DATOS, LUEGO DE CARGAR EL ARCHIVO, CON  ".responseText" LE ESTAMOS DICIENDO QUE NOS DEVUELVA LOS DATOS QUE HAYA, EL CONTENIDO, INFORMACION, ETC.

            var pacientes = JSON.parse(respuesta); // COMO ES UN ARCHIVO ".json" UTILIZAMOS ESE ELEMENTO, UTILIZAMOS UN ".parce" PARA PODER CONVERTIR LOS DATOS PARA QUE SE PUEDAN UTILIZAR (EN JSON) FACILMENTE, COMO PARAMETRO LE PASAMO LO QUE QUEREMOS TRANSFORMAR, EN ESTE CASO, LA VARIABLE DONDE TENEMOS TODOS LOS DATOS.

            pacientes.forEach(function(paciente) { //RECORREMOS A TODOS LOS PACIENTE Y LOS VAMOS AGREGANDO A LA TABLA.
                adicionarPacienteEnLaTabla(paciente);
            });
        } else {
            errorAjax.classList.remove("invisible"); // SI EL ERROR ES DIFERENTE A 200, REMOVEME ESA CLASE PARA QUE EL SPAN PUEDA SER VISIBLE.
        }
    });
    xhr.send(); // ACA LO ENVIAMOS A LA PAGINA, PERO NO LO ESTAMOS CARGANDO, SOLO ENVIANDO..
});